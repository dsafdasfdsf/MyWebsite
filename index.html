<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simple Money Game</title>
<style>
  /* Reset */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f8fa;
    color: #222;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  /* Top Bar */
  header {
    background: white;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
    padding: 12px 20px;
    display: flex;
    justify-content: center;
    gap: 15px;
    position: sticky;
    top: 0;
    z-index: 20;
  }
  button {
    background: #357edd;
    border: none;
    color: white;
    padding: 10px 20px;
    border-radius: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease;
    box-shadow: 0 4px 10px rgb(53 126 221 / 0.3);
  }
  button:hover:not(:disabled) {
    background: #255db1;
  }
  button:disabled {
    background: #a0a0a0;
    cursor: not-allowed;
    box-shadow: none;
  }
  /* Main Content */
  main {
    flex: 1;
    display: flex;
    gap: 25px;
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
  }
  /* Left Panel: Game + Shop + Cats */
  #gamePanel {
    flex: 2;
    background: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 4px 14px rgb(0 0 0 / 0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #welcomeMsg {
    font-size: 1.4rem;
    margin-bottom: 15px;
  }
  #moneyDisplay {
    font-size: 2rem;
    font-weight: 700;
    color: #2c7a2c;
    margin-bottom: 10px;
    user-select: none;
  }
  #countdown {
    font-size: 1.1rem;
    margin-bottom: 25px;
    color: #555;
  }
  #cats {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
    margin-bottom: 25px;
  }
  #cats img {
    width: 90px;
    height: 90px;
    object-fit: cover;
    border-radius: 18px;
    box-shadow: 0 3px 8px rgb(0 0 0 / 0.12);
    transform-origin: center;
    animation: floatAnim 6s ease-in-out infinite;
    cursor: default;
  }
  @keyframes floatAnim {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-12px); }
  }
  #shop {
    width: 100%;
    max-width: 500px;
    display: flex;
    justify-content: space-around;
  }
  #shop button {
    flex: 1;
    margin: 0 6px;
    background: #ff9f1c;
    box-shadow: 0 4px 10px rgb(255 159 28 / 0.5);
  }
  #shop button:hover:not(:disabled) {
    background: #cc7a00;
  }

  /* Right Panel: Admin controls */
  #leftPanel {
    flex: 1.3;
    background: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 4px 14px rgb(0 0 0 / 0.05);
    display: flex;
    flex-direction: column;
  }
  #leftPanel > h2 {
    margin: 0 0 10px;
    font-weight: 700;
    color: #444;
  }
  #playersList, #logs {
    flex: 1;
    background: #f0f2f5;
    border-radius: 15px;
    overflow-y: auto;
    padding: 10px;
    margin-bottom: 20px;
    font-family: monospace;
    font-size: 0.9rem;
    user-select: none;
  }
  #playersList div {
    padding: 8px 12px;
    border-radius: 10px;
    margin-bottom: 6px;
    cursor: pointer;
    transition: background-color 0.25s ease;
  }
  #playersList div.selected {
    background: #357edd;
    color: white;
    font-weight: 600;
  }
  #playersList div:hover {
    background: #d0e3ff;
  }
  #logs {
    font-size: 0.85rem;
    color: #333;
    background: #fafafa;
  }
  #banBtn {
    background: #e74c3c;
    margin-bottom: 0;
    padding: 12px 20px;
    border-radius: 18px;
    font-weight: 700;
    box-shadow: 0 4px 10px rgb(231 76 60 / 0.4);
  }
  #banBtn:disabled {
    background: #a0a0a0;
    box-shadow: none;
  }
  /* Logout button */
  #logoutBtn {
    background: #555;
    margin-top: auto;
  }

  /* Pop-up for errors */
  #popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    background: #e74c3c;
    color: white;
    padding: 18px 28px;
    border-radius: 25px;
    box-shadow: 0 8px 20px rgb(231 76 60 / 0.9);
    font-weight: 700;
    opacity: 0;
    pointer-events: none;
    user-select: none;
    transition: all 0.4s ease;
    z-index: 1000;
  }
  #popup.show {
    opacity: 1;
    pointer-events: auto;
    transform: translate(-50%, -50%) scale(1);
  }

  /* Modal background */
  .modal {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 900;
  }
  .modal.show {
    display: flex;
  }
  .modal-content {
    background: white;
    border-radius: 20px;
    padding: 25px 35px;
    width: 320px;
    box-shadow: 0 6px 25px rgb(0 0 0 / 0.15);
    position: relative;
    animation: modalAppear 0.4s ease forwards;
  }
  @keyframes modalAppear {
    from {opacity: 0; transform: translateY(-20px);}
    to {opacity: 1; transform: translateY(0);}
  }
  .modal-content h3 {
    margin-top: 0;
    margin-bottom: 15px;
    font-weight: 700;
    color: #333;
  }
  .modal-content label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
  }
  .modal-content input {
    width: 100%;
    padding: 9px 12px;
    border: 2px solid #ccc;
    border-radius: 12px;
    margin-bottom: 20px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }
  .modal-content input:focus {
    border-color: #357edd;
    outline: none;
  }
  .modal-content button {
    background: #357edd;
    color: white;
    font-weight: 700;
    padding: 10px 16px;
    border-radius: 15px;
    border: none;
    width: 100%;
    cursor: pointer;
    box-shadow: 0 4px 10px rgb(53 126 221 / 0.3);
    transition: background-color 0.3s ease;
  }
  .modal-content button:hover {
    background: #255db1;
  }
  .modal-content .cancel-btn {
    background: #aaa;
    margin-top: 10px;
  }
  .modal-content .cancel-btn:hover {
    background: #888;
  }

</style>
</head>
<body>

<header>
  <button id="loginBtn">Log In</button>
  <button id="signupBtn">Sign Up</button>
  <button id="logoutBtn" style="display:none;">Log Out</button>
</header>

<main>
  <!-- Left panel: game + shop + cats -->
  <section id="gamePanel" style="display:none;">
    <div id="welcomeMsg"></div>
    <div id="moneyDisplay">$0</div>
    <div id="countdown">Next $1 in: 30s</div>
    <div id="cats"></div>
    <div id="shop">
      <button data-item="Cool Hat" data-price="5">Buy Cool Hat ($5)</button>
      <button data-item="Fancy Shoes" data-price="10">Buy Fancy Shoes ($10)</button>
      <button data-item="Magic Potion" data-price="20">Buy Magic Potion ($20)</button>
    </div>
  </section>

  <!-- Right panel: admin panel -->
  <aside id="leftPanel" style="display:none; flex-direction: column;">
    <h2>Players List</h2>
    <div id="playersList" tabindex="0" aria-label="Players List"></div>
    <button id="banBtn" disabled>Ban Selected Player</button>

    <h2 style="margin-top:20px;">Admin Logs</h2>
    <div id="logs" aria-live="polite" aria-atomic="true" tabindex="0"></div>

    <button id="logoutBtn" style="background:#555;">Log Out</button>
  </aside>
</main>

<!-- Popup for errors -->
<div id="popup" role="alert" aria-live="assertive" aria-atomic="true"></div>

<!-- Login Modal -->
<div class="modal" id="loginModal" aria-hidden="true" role="dialog" aria-labelledby="loginTitle">
  <div class="modal-content">
    <h3 id="loginTitle">Log In</h3>
    <label for="loginUser">Username:</label>
    <input id="loginUser" autocomplete="username" />
    <label for="loginPass">Password:</label>
    <input id="loginPass" type="password" autocomplete="current-password" />
    <button id="loginSubmitBtn">Log In</button>
    <button class="cancel-btn" id="loginCancelBtn">Cancel</button>
  </div>
</div>

<!-- Signup Modal -->
<div class="modal" id="signupModal" aria-hidden="true" role="dialog" aria-labelledby="signupTitle">
  <div class="modal-content">
    <h3 id="signupTitle">Sign Up</h3>
    <label for="signupUser">Username:</label>
    <input id="signupUser" autocomplete="username" />
    <label for="signupPass">Password:</label>
    <input id="signupPass" type="password" autocomplete="new-password" />
    <button id="signupSubmitBtn">Sign Up</button>
    <button class="cancel-btn" id="signupCancelBtn">Cancel</button>
  </div>
</div>

<script>
(() => {
  // Constants
  const STORAGE_USERS = 'moneyGameUsers';
  const STORAGE_BANNED = 'moneyGameBanned';
  // DOM elements
  const loginBtn = document.getElementById('loginBtn');
  const signupBtn = document.getElementById('signupBtn');
  const logoutBtns = document.querySelectorAll('#logoutBtn'); // two logout buttons
  const leftPanel = document.getElementById('leftPanel');
  const gamePanel = document.getElementById('gamePanel');
  const welcomeMsg = document.getElementById('welcomeMsg');
  const moneyDisplay = document.getElementById('moneyDisplay');
  const countdown = document.getElementById('countdown');
  const playersList = document.getElementById('playersList');
  const logs = document.getElementById('logs');
  const banBtn = document.getElementById('banBtn');
  const catsDiv = document.getElementById('cats');
  const shop = document.getElementById('shop');

  // Pop-up
  const popup = document.getElementById('popup');

  // Modals
  const loginModal = document.getElementById('loginModal');
  const signupModal = document.getElementById('signupModal');

  // Login Modal Inputs + buttons
  const loginUserInput = document.getElementById('loginUser');
  const loginPassInput = document.getElementById('loginPass');
  const loginSubmitBtn = document.getElementById('loginSubmitBtn');
  const loginCancelBtn = document.getElementById('loginCancelBtn');

  // Signup Modal Inputs + buttons
  const signupUserInput = document.getElementById('signupUser');
  const signupPassInput = document.getElementById('signupPass');
  const signupSubmitBtn = document.getElementById('signupSubmitBtn');
  const signupCancelBtn = document.getElementById('signupCancelBtn');

  // Game Variables
  let users = {};
  let bannedUsers = {};
  let currentUser = null;
  let countdownInterval = null;
  let moneyInterval = null;
  let countdownTime = 30;

  // Selected player for ban
  let selectedPlayer = null;

  // Utility: show popup message
  function showPopup(message) {
    popup.textContent = message;
    popup.classList.add('show');
    setTimeout(() => {
      popup.classList.remove('show');
    }, 3500);
  }

  // Load data from localStorage
  function loadData() {
    const storedUsers = localStorage.getItem(STORAGE_USERS);
    users = storedUsers ? JSON.parse(storedUsers) : {};

    const storedBanned = localStorage.getItem(STORAGE_BANNED);
    bannedUsers = storedBanned ? JSON.parse(storedBanned) : {};

    // Create default admin 'cow' if missing
    if (!users['cow']) {
      users['cow'] = { password: 'cow', money: 0, isAdmin: true };
      saveUsers();
    }
  }
  function saveUsers() {
    localStorage.setItem(STORAGE_USERS, JSON.stringify(users));
  }
  function saveBanned() {
    localStorage.setItem(STORAGE_BANNED, JSON.stringify(bannedUsers));
  }

  // Render players list
  function renderPlayersList() {
    playersList.innerHTML = '';
    const usernames = Object.keys(users).sort();
    usernames.forEach(username => {
      const div = document.createElement('div');
      div.textContent = username + (users[username].isAdmin ? ' (Admin)' : '');
      if (selectedPlayer === username) {
        div.classList.add('selected');
      }
      div.addEventListener('click', () => {
        selectedPlayer = username === selectedPlayer ? null : username;
        renderPlayersList();
        updateBanButton();
      });
      playersList.appendChild(div);
    });
  }
  // Update ban button state
  function updateBanButton() {
    if (!selectedPlayer) {
      banBtn.disabled = true;
      return;
    }
    // Cannot ban self or admins
    if (selectedPlayer === currentUser || users[selectedPlayer]?.isAdmin) {
      banBtn.disabled = true;
    } else {
      banBtn.disabled = false;
    }
  }

  // Add log entry (admins only)
  function addLog(message) {
    if (!currentUser || !users[currentUser]?.isAdmin) return;
    const time = new Date().toLocaleTimeString();
    logs.textContent = `[${time}] ${message}\n` + logs.textContent;
  }

  // Show random cats every 10 seconds
  function loadCats() {
    catsDiv.innerHTML = '';
    for (let i = 0; i < 6; i++) {
      const img = document.createElement('img');
      img.alt = 'Random cat picture';
      img.src = `https://cataas.com/cat?random=${Math.floor(Math.random() * 10000) + i}`;
      catsDiv.appendChild(img);
    }
  }
  function refreshCats() {
    loadCats();
  }

  // Start money increment countdown
  function startCountdown() {
    let secondsLeft = countdownTime;
    countdown.textContent = `Next $1 in: ${secondsLeft}s`;
    if (countdownInterval) clearInterval(countdownInterval);

    countdownInterval = setInterval(() => {
      secondsLeft--;
      countdown.textContent = `Next $1 in: ${secondsLeft}s`;
      if (secondsLeft <= 0) {
        secondsLeft = countdownTime;
        addMoney(1);
      }
    }, 1000);
  }
  // Add money to current user
  function addMoney(amount) {
    if (!currentUser) return;
    users[currentUser].money += amount;
    saveUsers();
    updateMoneyDisplay();
    addLog(`Added $${amount} to ${currentUser}`);
  }

  // Update money display
  function updateMoneyDisplay() {
    if (!currentUser) return;
    moneyDisplay.textContent = `$${users[currentUser].money}`;
  }

  // Shop purchase handler
  function handlePurchase(itemName, price) {
    if (!currentUser) return;
    if (users[currentUser].money < price) {
      showPopup("You don't have enough money!");
      return;
    }
    users[currentUser].money -= price;
    saveUsers();
    updateMoneyDisplay();
    addLog(`${currentUser} bought ${itemName} for $${price}`);
    showPopup(`You bought ${itemName}!`);
  }

  // Ban player
  function banPlayer() {
    if (!selectedPlayer || !users[selectedPlayer]) return;
    bannedUsers[selectedPlayer] = true;
    saveBanned();
    delete users[selectedPlayer];
    saveUsers();
    addLog(`Admin ${currentUser} banned player: ${selectedPlayer}`);
    if (selectedPlayer === currentUser) logoutUser();
    else {
      selectedPlayer = null;
      renderPlayersList();
      updateBanButton();
      showPopup(`${selectedPlayer} has been banned`);
    }
  }

  // Log out
  function logoutUser() {
    currentUser = null;
    selectedPlayer = null;
    clearInterval(countdownInterval);
    clearInterval(moneyInterval);
    updateUI();
  }

  // Update UI based on login/admin status
  function updateUI() {
    if (!currentUser) {
      gamePanel.style.display = 'none';
      leftPanel.style.display = 'none';
      loginBtn.style.display = 'inline-block';
      signupBtn.style.display = 'inline-block';
      logoutBtns.forEach(btn => (btn.style.display = 'none'));
    } else {
      loginBtn.style.display = 'none';
      signupBtn.style.display = 'none';
      logoutBtns.forEach(btn => (btn.style.display = 'inline-block'));

      gamePanel.style.display = 'flex';
      welcomeMsg.textContent = `Welcome, ${currentUser}${users[currentUser].isAdmin ? ' (Admin)' : ''}!`;
      updateMoneyDisplay();
      startCountdown();
      loadCats();

      if (users[currentUser].isAdmin) {
        leftPanel.style.display = 'flex';
        renderPlayersList();
        updateBanButton();
      } else {
        leftPanel.style.display = 'none';
      }
    }
  }

  // Show login modal
  function showLogin() {
    loginModal.classList.add('show');
    loginModal.setAttribute('aria-hidden', 'false');
    loginUserInput.value = '';
    loginPassInput.value = '';
    loginUserInput.focus();
  }
  // Hide login modal
  function hideLogin() {
    loginModal.classList.remove('show');
    loginModal.setAttribute('aria-hidden', 'true');
  }
  // Show signup modal
  function showSignup() {
    signupModal.classList.add('show');
    signupModal.setAttribute('aria-hidden', 'false');
    signupUserInput.value = '';
    signupPassInput.value = '';
    signupUserInput.focus();
  }
  // Hide signup modal
  function hideSignup() {
    signupModal.classList.remove('show');
    signupModal.setAttribute('aria-hidden', 'true');
  }

  // Login handler
  function handleLogin() {
    const user = loginUserInput.value.trim().toLowerCase();
    const pass = loginPassInput.value.trim();
    if (!user || !pass) {
      showPopup("Please enter username and password");
      return;
    }
    if (bannedUsers[user]) {
      showPopup("Error: This user is banned");
      hideLogin();
      return;
    }
    if (!users[user] || users[user].password !== pass) {
      showPopup("Invalid username or password");
      return;
    }
    currentUser = user;
    hideLogin();
    updateUI();
    addLog(`${currentUser} logged in`);
  }

  // Signup handler
  function handleSignup() {
    const user = signupUserInput.value.trim().toLowerCase();
    const pass = signupPassInput.value.trim();
    if (!user || !pass) {
      showPopup("Please enter username and password");
      return;
    }
    if (users[user]) {
      showPopup("User already exists");
      return;
    }
    if (bannedUsers[user]) {
      showPopup("This username is banned");
      return;
    }
    users[user] = { password: pass, money: 0, isAdmin: false };
    saveUsers();
    currentUser = user;
    hideSignup();
    updateUI();
    addLog(`New user signed up: ${user}`);
  }

  // Event listeners
  loginBtn.addEventListener('click', showLogin);
  signupBtn.addEventListener('click', showSignup);
  loginCancelBtn.addEventListener('click', hideLogin);
  signupCancelBtn.addEventListener('click', hideSignup);
  loginSubmitBtn.addEventListener('click', handleLogin);
  signupSubmitBtn.addEventListener('click', handleSignup);
  banBtn.addEventListener('click', banPlayer);

  // Initial load
  loadData();
  updateUI();

  // Refresh cats every 10 seconds
  setInterval(refreshCats, 10000);
})();</script>

</body>
</html>
